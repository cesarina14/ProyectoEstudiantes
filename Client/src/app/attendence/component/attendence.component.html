
<div class="container">

    <div class="col-md-12 row">
        <h1><i class="pi pi-list"></i> Control Asistencia </h1>
    
        <div class="p-fluid col-md-12 row">
            <div class="row col-md-12 mb-3">
            
                <div class="d-flex justify-content-end">
                    <button class="btn btn-primary" (click)="ShowModal()" >
                        <i class="pi pi-list"></i> Pasar Lista
                    </button>
                </div>
            </div>
            <div class="col-md-3 form-group">
                <!-- <i class="pi pi-search"></i> -->
            <input type="text"  placeholder="Buscar...." (input)="dt.filterGlobal($event.target.value, 'contains')" class="form-control mb-3"  />
            </div>
                
             
                <p-table [value]="AttendanceWithStudentTable" [paginator]="true" [rows]="10" #dt  [paginator]="true" [rows]="10" [globalFilterFields]="['StudentName', 'Date']">
                  <ng-template pTemplate="header">
                    <tr>
                    <th>#</th>
                      <th>Fecha</th>
                      <th>Estudiante</th>
                      <th>Presente</th>
                      <th>Fecha Creaci√≥n</th>
                      <th>Accion</th>
                    </tr>
                  </ng-template>
                  <ng-template pTemplate="body" let-record let-i="rowIndex">
                    <tr>
                        <td>{{record.Id}}</td>
                      <td>{{ record.Date | date:'yyyy-MM-dd' }}</td>
                      <td>{{ record.StudentName }}</td>
                     
                        <td>
                            <ng-container *ngIf="record.IsPresent; else absentBlock">
                              <button class="btn btn-success">Presente</button>
                            </ng-container>
                            <ng-template #absentBlock>
                              <button class="btn btn-primary">Ausente</button>
                            </ng-template>
                          </td>
                          
                  <td>{{record.CreatedAt | date:'yyyy-MM-dd' }}</td>
                      <td>
                        <button class="btn btn-primary" (click)="EditAttendence(i)" ><i class="pi pi-pencil"></i></button>
         
                      </td>
                    </tr>
                  </ng-template>
                </p-table>
              </div>
              
    </div>
    
      


<!-- Modal -->
<div class="modal-overlay" *ngIf="ShowDialog">
    <p-dialog  [(visible)]="ShowDialog" [modal]="true" [style]="{width: '500px'}">
        <div class="modal-header">
            <h2 id="modalTitle">Pase de Lista</h2>
          </div>
        <div class="modal-body">
          <div class="p-fluid">
              <div class="col-md-12 mt-4">
                <p-table [value]="AttendanceWithStudentList">
                    <ng-template pTemplate="header">
                      <tr>
                        <th>Nombre</th>
                        <th>Presente</th>
                      </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-estudiante>
                      <tr>
                        <td>{{ estudiante.StudentName }}</td>
                        <td>
                          <input type="checkbox" [(ngModel)]="estudiante.IsPresent" name="asistencia{{estudiante.StudentId}}">
                        </td>
                      </tr>
                    </ng-template>
                  </p-table>        
              </div>    
            </div>
            <div class="modal-footer">
                <div class="mt-2 mb-4">
                    <button class="btn btn-success" label="Save" (click)="Save()"><i class="pi pi-save"></i> Guardar</button>
                 </div>
              <div class="mt-2 mb-4 m-2">
                <button class="btn  btn-secondary" label="Cancel" severity="secondary" (click)="Hide()"> <i class="pi pi-times"></i> Cerrar</button>
              </div>
          </div>
        </div>
       
      </p-dialog>



</div>

</div>
<p-toast></p-toast>

  


 
  